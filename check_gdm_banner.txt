echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKIyBBdWRpdCBTY3JpcHQgZm9yIEdETSBCYW5uZXIgQ29uZmlndXJhdGlvbgoKewogIGxfcGtnb3V0cHV0PSIiCiAgCiAgIyBEZXRlY3QgcGFja2FnZSBtYW5hZ2VyIGFuZCBzZXQgdGhlIHBhY2thZ2UgcXVlcnkgY29tbWFuZAogIGlmIGNvbW1hbmQgLXYgZHBrZy1xdWVyeSA+IC9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICBsX3BxPSJkcGtnLXF1ZXJ5IC1XIgogIGVsaWYgY29tbWFuZCAtdiBycG0gPiAvZGV2L251bGwgMj4mMTsgdGhlbgogICAgbF9wcT0icnBtIC1xIgogIGVsc2UKICAgIGVjaG8gIk5vIHN1cHBvcnRlZCBwYWNrYWdlIG1hbmFnZXIgZm91bmQgb24gdGhpcyBzeXN0ZW0uIgogICAgZXhpdCAxCiAgZmkKCiAgIyBMaXN0IG9mIEdETSBwYWNrYWdlcyB0byBjaGVjawogIGxfcGNsPSJnZG0gZ2RtMyIKCiAgIyBDaGVjayBpZiBHRE0gaXMgaW5zdGFsbGVkCiAgZm9yIGxfcG4gaW4gJGxfcGNsOyBkbwogICAgJGxfcHEgIiRsX3BuIiA+IC9kZXYvbnVsbCAyPiYxICYmIGxfcGtnb3V0cHV0PSIkbF9wa2dvdXRwdXRcbiAtIFBhY2thZ2U6IFwiJGxfcG5cIiBleGlzdHMgb24gdGhlIHN5c3RlbVxuIC0gQ2hlY2tpbmcgY29uZmlndXJhdGlvbiIKICBkb25lCgogIGlmIFsgLW4gIiRsX3BrZ291dHB1dCIgXTsgdGhlbgogICAgbF9vdXRwdXQ9IiIKICAgIGxfb3V0cHV0Mj0iIgoKICAgICMgT3V0cHV0IGRldGVjdGVkIHBhY2thZ2VzCiAgICBlY2hvIC1lICIkbF9wa2dvdXRwdXQiCgogICAgIyBDaGVjayBjb25maWd1cmF0aW9uIGZpbGVzIGZvciBiYW5uZXItbWVzc2FnZS1lbmFibGUgYW5kIGJhbm5lci1tZXNzYWdlLXRleHQKICAgIGxfZ2RtZmlsZT0iJChncmVwIC1QcmlscyAnXlxoKmJhbm5lci1tZXNzYWdlLWVuYWJsZVxiJyAvZXRjL2Rjb25mL2RiLyouZCkiCiAgICBpZiBbIC1uICIkbF9nZG1maWxlIiBdOyB0aGVuCiAgICAgICMgRGV0ZXJtaW5lIHByb2ZpbGUgbmFtZSBiYXNlZCBvbiBkY29uZiBkYXRhYmFzZSBkaXJlY3RvcnkKICAgICAgbF9nZG1wcm9maWxlPSIkKGF3ayAtRlwvICd7c3BsaXQoJChORi0xKSxhLCIuIik7cHJpbnQgYVsxXX0nIDw8PCAiJGxfZ2RtZmlsZSIpIgoKICAgICAgIyBDaGVjayBpZiBiYW5uZXItbWVzc2FnZS1lbmFibGUgaXMgc2V0IHRvIHRydWUKICAgICAgaWYgZ3JlcCAtUGlzcSAnXlxoKmJhbm5lci1tZXNzYWdlLWVuYWJsZT10cnVlXGInICIkbF9nZG1maWxlIjsgdGhlbgogICAgICAgIGxfb3V0cHV0PSIkbF9vdXRwdXRcbiAtIFRoZSBcImJhbm5lci1tZXNzYWdlLWVuYWJsZVwiIG9wdGlvbiBpcyBlbmFibGVkIGluIFwiJGxfZ2RtZmlsZVwiIgogICAgICBlbHNlCiAgICAgICAgbF9vdXRwdXQyPSIkbF9vdXRwdXQyXG4gLSBUaGUgXCJiYW5uZXItbWVzc2FnZS1lbmFibGVcIiBvcHRpb24gaXMgbm90IGVuYWJsZWQiCiAgICAgIGZpCgogICAgICAjIENoZWNrIGZvciBiYW5uZXItbWVzc2FnZS10ZXh0IHNldHRpbmcKICAgICAgbF9sc2J0PSIkKGdyZXAgLVBpb3MgJ15caCpiYW5uZXItbWVzc2FnZS10ZXh0PS4qJCcgIiRsX2dkbWZpbGUiKSIKICAgICAgaWYgWyAtbiAiJGxfbHNidCIgXTsgdGhlbgogICAgICAgIGxfb3V0cHV0PSIkbF9vdXRwdXRcbiAtIFRoZSBcImJhbm5lci1tZXNzYWdlLXRleHRcIiBvcHRpb24gaXMgc2V0IGluIFwiJGxfZ2RtZmlsZVwiXG4gLSBiYW5uZXItbWVzc2FnZS10ZXh0IGlzIHNldCB0bzpcbiAgIFwiJGxfbHNidFwiIgogICAgICBlbHNlCiAgICAgICAgbF9vdXRwdXQyPSIkbF9vdXRwdXQyXG4gLSBUaGUgXCJiYW5uZXItbWVzc2FnZS10ZXh0XCIgb3B0aW9uIGlzIG5vdCBzZXQiCiAgICAgIGZpCgogICAgICAjIFZlcmlmeSBwcm9maWxlIGV4aXN0cyBpbiBkY29uZiBwcm9maWxlCiAgICAgIGlmIGdyZXAgLVBxICJeXGgqc3lzdGVtLWRiOiRsX2dkbXByb2ZpbGUiIC9ldGMvZGNvbmYvcHJvZmlsZS8iJGxfZ2RtcHJvZmlsZSI7IHRoZW4KICAgICAgICBsX291dHB1dD0iJGxfb3V0cHV0XG4gLSBUaGUgXCIkbF9nZG1wcm9maWxlXCIgcHJvZmlsZSBleGlzdHMiCiAgICAgIGVsc2UKICAgICAgICBsX291dHB1dDI9IiRsX291dHB1dDJcbiAtIFRoZSBcIiRsX2dkbXByb2ZpbGVcIiBwcm9maWxlIGRvZXNuJ3QgZXhpc3QiCiAgICAgIGZpCgogICAgICAjIFZlcmlmeSBwcm9maWxlIGV4aXN0cyBpbiBkY29uZiBkYXRhYmFzZQogICAgICBpZiBbIC1mICIvZXRjL2Rjb25mL2RiLyRsX2dkbXByb2ZpbGUiIF07IHRoZW4KICAgICAgICBsX291dHB1dD0iJGxfb3V0cHV0XG4gLSBUaGUgXCIkbF9nZG1wcm9maWxlXCIgcHJvZmlsZSBleGlzdHMgaW4gdGhlIGRjb25mIGRhdGFiYXNlIgogICAgICBlbHNlCiAgICAgICAgbF9vdXRwdXQyPSIkbF9vdXRwdXQyXG4gLSBUaGUgXCIkbF9nZG1wcm9maWxlXCIgcHJvZmlsZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBkY29uZiBkYXRhYmFzZSIKICAgICAgZmkKCiAgICBlbHNlCiAgICAgIGxfb3V0cHV0Mj0iJGxfb3V0cHV0MlxuIC0gVGhlIFwiYmFubmVyLW1lc3NhZ2UtZW5hYmxlXCIgb3B0aW9uIGlzbid0IGNvbmZpZ3VyZWQiCiAgICBmaQogIGVsc2UKICAgIGVjaG8gLWUgIlxuXG4gLSBHTk9NRSBEZXNrdG9wIE1hbmFnZXIgaXNuJ3QgaW5zdGFsbGVkXG4gLSBSZWNvbW1lbmRhdGlvbiBpcyBOb3QgQXBwbGljYWJsZVxuIC0gQXVkaXQgcmVzdWx0OlxuICoqKiBQQVNTICoqKlxuIgogICAgZXhpdCAwCiAgZmkKCiAgIyBSZXBvcnQgcmVzdWx0cwogIGlmIFsgLXogIiRsX291dHB1dDIiIF07IHRoZW4KICAgIGVjaG8gLWUgIlxuLSBBdWRpdCBSZXN1bHQ6XG4gKiogUEFTUyAqKlxuJGxfb3V0cHV0XG4iCiAgZWxzZQogICAgZWNobyAtZSAiXG4tIEF1ZGl0IFJlc3VsdDpcbiAqKiBGQUlMICoqXG4gLSBSZWFzb24ocykgZm9yIGF1ZGl0IGZhaWx1cmU6XG4kbF9vdXRwdXQyXG4iCiAgICBbIC1uICIkbF9vdXRwdXQiIF0gJiYgZWNobyAtZSAiXG4tIENvcnJlY3RseSBzZXQ6XG4kbF9vdXRwdXRcbiIKICBmaQp9Cg==" | base64 -d | bash

  ---] output
   - Package: "gdm" exists on the system
 - Checking configuration

- Audit Result:
 ** FAIL **
 - Reason(s) for audit failure:

 - The "banner-message-enable" option isn't configured
