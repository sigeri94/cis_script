echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKIyBBdWRpdCBTY3JpcHQgZm9yIFNDVFAgS2VybmVsIE1vZHVsZQoKewogIGxfbW9kX25hbWU9InNjdHAiICAgICAjIEtlcm5lbCBtb2R1bGUgbmFtZQogIGxfbW9kX3R5cGU9Im5ldCIgICAgICAjIEtlcm5lbCBtb2R1bGUgdHlwZQogIGxfbW9kX3BhdGg9IiQocmVhZGxpbmsgLWYgL2xpYi9tb2R1bGVzLyoqL2tlcm5lbC8kbF9tb2RfdHlwZSB8IHNvcnQgLXUpIiAjIE1vZHVsZSBwYXRoCiAgYV9vdXRwdXQ9KCkgICAgICAgICAgICMgQXJyYXkgZm9yIFBBU1MgY29uZGl0aW9ucwogIGFfb3V0cHV0Mj0oKSAgICAgICAgICAjIEFycmF5IGZvciBGQUlMIGNvbmRpdGlvbnMKICBsX291dHB1dDM9IiIgICAgICAgICAgIyBTdG9yZXMgZXhpc3RpbmcgbW9kdWxlIHBhdGhzCgogICMgRnVuY3Rpb24gdG8gY2hlY2sgbW9kdWxlIHN0YXR1cyBhbmQgY29uZmlndXJhdGlvbgogIGZfbW9kdWxlX2NoaygpIHsKICAgIGFfc2hvd2NvbmZpZz0oKSAgICAgIyBBcnJheSB0byBob2xkIG1vZHByb2JlIGNvbmZpZ3VyYXRpb24KCiAgICAjIFJldHJpZXZlIG1vZHByb2JlIGNvbmZpZ3VyYXRpb25zIGZvciB0aGUgbW9kdWxlCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgbF9zaG93Y29uZmlnOyBkbwogICAgICBhX3Nob3djb25maWcrPSgiJGxfc2hvd2NvbmZpZyIpCiAgICBkb25lIDwgPChtb2Rwcm9iZSAtLXNob3djb25maWcgfCBncmVwIC1QIC0tICdcYihpbnN0YWxsfGJsYWNrbGlzdClcaCsnIiR7bF9tb2RfbmFtZS8vLS9ffSInXGInKQoKICAgICMgQ2hlY2sgaWYgdGhlIG1vZHVsZSBpcyBsb2FkZWQKICAgIGlmICEgbHNtb2QgfCBncmVwIC1xICIkbF9tb2RfbmFtZSI7IHRoZW4KICAgICAgYV9vdXRwdXQrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIG5vdCBsb2FkZWQiKQogICAgZWxzZQogICAgICBhX291dHB1dDIrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIGxvYWRlZCIpCiAgICBmaQoKICAgICMgQ2hlY2sgaWYgdGhlIG1vZHVsZSBpcyBzZXQgdG8gL2Jpbi90cnVlIG9yIC9iaW4vZmFsc2UKICAgIGlmIGdyZXAgLVBxIC0tICdcYmluc3RhbGxcaCsnIiR7bF9tb2RfbmFtZS8vLS9ffSInXGgrXC9iaW5cLyh0cnVlfGZhbHNlKVxiJyA8PDwgIiR7YV9zaG93Y29uZmlnWypdfSI7IHRoZW4KICAgICAgYV9vdXRwdXQrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIG5vdCBsb2FkYWJsZSIpCiAgICBlbHNlCiAgICAgIGFfb3V0cHV0Mis9KCIgLSBrZXJuZWwgbW9kdWxlOiBcIiRsX21vZF9uYW1lXCIgaXMgbG9hZGFibGUiKQogICAgZmkKCiAgICAjIENoZWNrIGlmIHRoZSBtb2R1bGUgaXMgZGVueWxpc3RlZAogICAgaWYgZ3JlcCAtUHEgLS0gJ1xiYmxhY2tsaXN0XGgrJyIke2xfbW9kX25hbWUvLy0vX30iJ1xiJyA8PDwgIiR7YV9zaG93Y29uZmlnWypdfSI7IHRoZW4KICAgICAgYV9vdXRwdXQrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIGRlbnkgbGlzdGVkIikKICAgIGVsc2UKICAgICAgYV9vdXRwdXQyKz0oIiAtIGtlcm5lbCBtb2R1bGU6IFwiJGxfbW9kX25hbWVcIiBpcyBub3QgZGVueSBsaXN0ZWQiKQogICAgZmkKICB9CgogICMgQ2hlY2sgaWYgdGhlIG1vZHVsZSBleGlzdHMgaW4gdGhlIHN5c3RlbQogIGZvciBsX21vZF9iYXNlX2RpcmVjdG9yeSBpbiAkbF9tb2RfcGF0aDsgZG8KICAgIGlmIFsgLWQgIiRsX21vZF9iYXNlX2RpcmVjdG9yeS8ke2xfbW9kX25hbWUvLS9cL30iIF0gJiYgWyAtbiAiJChscyAtQSAiJGxfbW9kX2Jhc2VfZGlyZWN0b3J5LyR7bF9tb2RfbmFtZS8tL1wvfSIpIiBdOyB0aGVuCiAgICAgIGxfb3V0cHV0Mz0iJGxfb3V0cHV0M1xuIC0gXCIkbF9tb2RfYmFzZV9kaXJlY3RvcnlcIiIKICAgICAgZl9tb2R1bGVfY2hrCiAgICBlbHNlCiAgICAgIGFfb3V0cHV0Kz0oIiAtIGtlcm5lbCBtb2R1bGU6IFwiJGxfbW9kX25hbWVcIiBkb2Vzbid0IGV4aXN0IGluIFwiJGxfbW9kX2Jhc2VfZGlyZWN0b3J5XCIiKQogICAgZmkKICBkb25lCgogICMgRGlzcGxheSByZXN1bHRzCiAgWyAtbiAiJGxfb3V0cHV0MyIgXSAmJiBlY2hvIC1lICJcblxuIC0tIElORk8gLS1cbiAtIE1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGV4aXN0cyBpbjokbF9vdXRwdXQzIgogIGlmIFsgIiR7I2Ffb3V0cHV0MltAXX0iIC1lcSAwIF07IHRoZW4KICAgIGVjaG8gLWUgIlxuLSBBdWRpdCBSZXN1bHQ6XG4gKiogUEFTUyAqKlxuJHthX291dHB1dFsqXX0iCiAgZWxzZQogICAgZWNobyAtZSAiXG4tIEF1ZGl0IFJlc3VsdDpcbiAqKiBGQUlMICoqXG4gLSBSZWFzb24ocykgZm9yIGF1ZGl0IGZhaWx1cmU6XG4ke2Ffb3V0cHV0MlsqXX0iCiAgICBbICIkeyNhX291dHB1dFtAXX0iIC1ndCAwIF0gJiYgZWNobyAtZSAiXG4tIENvcnJlY3RseSBzZXQ6XG4ke2Ffb3V0cHV0WypdfSIKICBmaQp9Cg==" | base64 -d | bash

---] output
 -- INFO --
 - Module: "sctp" exists in:
 - "/usr/lib/modules/6.8.0-40-generic/kernel/net"
 - "/usr/lib/modules/6.8.0-49-generic/kernel/net"

- Audit Result:
 ** FAIL **
 - Reason(s) for audit failure:
 - kernel module: "sctp" is loadable  - kernel module: "sctp" is not deny listed  - kernel module: "sctp" is loadable  - kernel module: "sctp" is not deny listed

- Correctly set:
 - kernel module: "sctp" is not loaded  - kernel module: "sctp" is not loaded
