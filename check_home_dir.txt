echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKewogICAgbF9vdXRwdXQ9IiIKICAgIGxfb3V0cHV0Mj0iIgogICAgbF9oZW91dDI9IiIKICAgIGxfaG9vdXQyPSIiCiAgICBsX2hhb3V0Mj0iIgoKICAgICMgRGVmaW5lIHZhbGlkIHNoZWxscyByZWdleCBmcm9tIC9ldGMvc2hlbGxzCiAgICBsX3ZhbGlkX3NoZWxscz0iXigkKGF3ayAtRi8gJyRORiAhPSAibm9sb2dpbiIge3ByaW50fScgL2V0Yy9zaGVsbHMgfCBzZWQgLXIgJy9eXC8ve3MsLyxcXFxcLyxnO3B9JyB8IHBhc3RlIC1zIC1kICd8JyAtKSkkIgoKICAgICMgQ2xlYXIgYW5kIGluaXRpYWxpemUgdGhlIGFycmF5CiAgICB1bnNldCBhX3VhcnIgJiYgYV91YXJyPSgpCgogICAgIyBQb3B1bGF0ZSBhcnJheSB3aXRoIHVzZXJzIGFuZCB0aGVpciBob21lIGRpcmVjdG9yaWVzCiAgICB3aGlsZSByZWFkIC1yIGxfZXB1IGxfZXBoOyBkbwogICAgICAgIGFfdWFycis9KCIkbF9lcHUgJGxfZXBoIikKICAgIGRvbmUgPDw8ICIkKGF3ayAtdiBwYXQ9IiRsX3ZhbGlkX3NoZWxscyIgLUY6ICckKE5GKSB+IHBhdCB7IHByaW50ICQxLCAkKE5GLTEpIH0nIC9ldGMvcGFzc3dkKSIKCiAgICBsX2FzaXplPSIkeyNhX3VhcnJbQF19IiAjIENoZWNrIHRoZSBudW1iZXIgb2YgdXNlcnMKCiAgICAjIEluZm8gbWVzc2FnZSBpZiBtYW55IHVzZXJzIGFyZSBmb3VuZAogICAgaWYgWyAiJGxfYXNpemUiIC1ndCAxMDAwMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiXG4gKiogSU5GTyAqKlxuIC0gXCIkbF9hc2l6ZVwiIGxvY2FsIGludGVyYWN0aXZlIHVzZXJzIGZvdW5kIG9uIHRoZSBzeXN0ZW1cbiAtIFRoaXMgbWF5IGJlIGEgbG9uZy1ydW5uaW5nIGNoZWNrXG4iCiAgICBmaQoKICAgICMgSXRlcmF0ZSBvdmVyIHVzZXJzIGFuZCB0aGVpciBob21lIGRpcmVjdG9yaWVzCiAgICB3aGlsZSByZWFkIC1yIGxfdXNlciBsX2hvbWU7IGRvCiAgICAgICAgaWYgWyAtZCAiJGxfaG9tZSIgXTsgdGhlbgogICAgICAgICAgICBsX21hc2s9IjAwMjciCiAgICAgICAgICAgIGxfbWF4PSIkKHByaW50ZiAnJW8nICQoKDA3NzcgJiB+JGxfbWFzaykpKSIKCiAgICAgICAgICAgIHdoaWxlIHJlYWQgLXIgbF9vd24gbF9tb2RlOyBkbwogICAgICAgICAgICAgICAgIyBDaGVjayBpZiBob21lIGRpcmVjdG9yeSBpcyBvd25lZCBieSB0aGUgdXNlcgogICAgICAgICAgICAgICAgaWYgWyAiJGxfdXNlciIgIT0gIiRsX293biIgXTsgdGhlbgogICAgICAgICAgICAgICAgICAgIGxfaG9vdXQyPSIkbF9ob291dDJcbiAtIFVzZXI6IFwiJGxfdXNlclwiIEhvbWUgXCIkbF9ob21lXCIgaXMgb3duZWQgYnk6IFwiJGxfb3duXCIiCiAgICAgICAgICAgICAgICBmaQoKICAgICAgICAgICAgICAgICMgQ2hlY2sgaWYgaG9tZSBkaXJlY3RvcnkgbW9kZSBpcyB0b28gcGVybWlzc2l2ZQogICAgICAgICAgICAgICAgaWYgWyAkKChsX21vZGUgJiBsX21hc2spKSAtZ3QgMCBdOyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbF9oYW91dDI9IiRsX2hhb3V0MlxuIC0gVXNlcjogXCIkbF91c2VyXCIgSG9tZSBcIiRsX2hvbWVcIiBpcyBtb2RlOiBcIiRsX21vZGVcIiBzaG91bGQgYmUgbW9kZTogXCIkbF9tYXhcIiBvciBtb3JlIHJlc3RyaWN0aXZlIgogICAgICAgICAgICAgICAgZmkKICAgICAgICAgICAgZG9uZSA8PDwgIiQoc3RhdCAtTGMgJyVVICUjYScgIiRsX2hvbWUiKSIKICAgICAgICBlbHNlCiAgICAgICAgICAgICMgSG9tZSBkaXJlY3RvcnkgZG9lcyBub3QgZXhpc3QKICAgICAgICAgICAgbF9oZW91dDI9IiRsX2hlb3V0MlxuIC0gVXNlcjogXCIkbF91c2VyXCIgSG9tZSBcIiRsX2hvbWVcIiBkb2Vzbid0IGV4aXN0IgogICAgICAgIGZpCiAgICBkb25lIDw8PCAiJChwcmludGYgJyVzXG4nICIke2FfdWFycltAXX0iKSIKCiAgICAjIEdlbmVyYXRlIG91dHB1dCBiYXNlZCBvbiBmaW5kaW5ncwogICAgWyAteiAiJGxfaGVvdXQyIiBdICYmIGxfb3V0cHV0PSIkbF9vdXRwdXRcbiAtIEhvbWUgZGlyZWN0b3JpZXMgZXhpc3QiIHx8IGxfb3V0cHV0Mj0iJGxfb3V0cHV0MiRsX2hlb3V0MiIKICAgIFsgLXogIiRsX2hvb3V0MiIgXSAmJiBsX291dHB1dD0iJGxfb3V0cHV0XG4gLSBVc2VycyBvd24gdGhlaXIgaG9tZSBkaXJlY3RvcnkiIHx8IGxfb3V0cHV0Mj0iJGxfb3V0cHV0MiRsX2hvb3V0MiIKICAgIFsgLXogIiRsX2hhb3V0MiIgXSAmJiBsX291dHB1dD0iJGxfb3V0cHV0XG4gLSBIb21lIGRpcmVjdG9yaWVzIGFyZSBtb2RlOiBcIiRsX21heFwiIG9yIG1vcmUgcmVzdHJpY3RpdmUiIHx8IGxfb3V0cHV0Mj0iJGxfb3V0cHV0MiRsX2hhb3V0MiIKCiAgICBbIC1uICIkbF9vdXRwdXQiIF0gJiYgbF9vdXRwdXQ9IiAtIEFsbCBsb2NhbCBpbnRlcmFjdGl2ZSB1c2VyczokbF9vdXRwdXQiCgogICAgIyBGaW5hbCByZXN1bHQgb3V0cHV0CiAgICBpZiBbIC16ICIkbF9vdXRwdXQyIiBdOyB0aGVuCiAgICAgICAgIyBQYXNzIGlmIG5vIGlzc3VlcyBmb3VuZAogICAgICAgIGVjaG8gLWUgIlxuLSBBdWRpdCBSZXN1bHQ6XG4gKiogUEFTUyAqKlxuIC0gKiBDb3JyZWN0bHkgY29uZmlndXJlZCAqIDpcbiRsX291dHB1dCIKICAgIGVsc2UKICAgICAgICAjIEZhaWwgaWYgaXNzdWVzIGV4aXN0CiAgICAgICAgZWNobyAtZSAiXG4tIEF1ZGl0IFJlc3VsdDpcbiAqKiBGQUlMICoqXG4gLSAqIFJlYXNvbnMgZm9yIGF1ZGl0IGZhaWx1cmUgKiA6XG4kbF9vdXRwdXQyIgogICAgICAgIFsgLW4gIiRsX291dHB1dCIgXSAmJiBlY2hvIC1lICJcbi0gKiBDb3JyZWN0bHkgY29uZmlndXJlZCAqIDpcbiRsX291dHB1dCIKICAgIGZpCn0K" | base64 -d | bash

  --] output

- Audit Result:
 ** FAIL **
 - * Reasons for audit failure * :

 - User: "nonexistent_user" Home "/home/nonexistent_user" doesn't exist
 - User: "user2" Home "/home/user2" is owned by: "nonexistent_user"
 - User: "user3" Home "/home/user3" is owned by: "UNKNOWN"

- * Correctly configured * :
 - All local interactive users:
 - Home directories are mode: "750" or more restrictive

