echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKewogICAgbF9vdXRwdXQ9IiIgICMgVG8gc3RvcmUgc3VjY2VzcyBtZXNzYWdlcwogICAgbF9vdXRwdXQyPSIiICMgVG8gc3RvcmUgZmFpbHVyZSBtZXNzYWdlcwoKICAgICMgRnVuY3Rpb24gdG8gY2hlY2sgZmlsZSBtb2RlLCB1c2VyLCBhbmQgZ3JvdXAKICAgIGZpbGVfbXVnX2NoaygpIHsKICAgICAgICBsX291dD0iIiAgIyBMb2NhbCB2YXJpYWJsZSBmb3Igc3VjY2VzcyBkZXRhaWxzCiAgICAgICAgbF9vdXQyPSIiICMgTG9jYWwgdmFyaWFibGUgZm9yIGZhaWx1cmUgZGV0YWlscwoKICAgICAgICAjIERldGVybWluZSBwZXJtaXNzaW9uIG1hc2sgYmFzZWQgb24gZmlsZSBsb2NhdGlvbgogICAgICAgIGlmIFtbICIkKGRpcm5hbWUgIiRsX2ZpbGUiKSIgPX4gXi9ib290L2VmaS9FRkkgXV07IHRoZW4KICAgICAgICAgICAgbF9wbWFzaz0iMDA3NyIKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxfcG1hc2s9IjAxNzciCiAgICAgICAgZmkKCiAgICAgICAgIyBDYWxjdWxhdGUgbWF4aW11bSBhbGxvd2VkIHBlcm1pc3Npb25zCiAgICAgICAgbF9tYXhwZXJtPSIkKHByaW50ZiAnJW8nICQoKDA3NzcgJiB+JGxfcG1hc2spKSkiCgogICAgICAgICMgQ2hlY2sgZmlsZSBtb2RlCiAgICAgICAgaWYgWyAkKChsX21vZGUgJiBsX3BtYXNrKSkgLWd0IDAgXTsgdGhlbgogICAgICAgICAgICBsX291dDI9IiRsX291dDJcbiAgLSBJcyBtb2RlIFwiJGxfbW9kZVwiIGFuZCBzaG91bGQgYmUgbW9kZSBcIiRsX21heHBlcm1cIiBvciBtb3JlIHJlc3RyaWN0aXZlIgogICAgICAgIGVsc2UKICAgICAgICAgICAgbF9vdXQ9IiRsX291dFxuICAtIElzIGNvcnJlY3RseSBtb2RlOiBcIiRsX21vZGVcIiB3aGljaCBpcyBtb2RlIFwiJGxfbWF4cGVybVwiIG9yIG1vcmUgcmVzdHJpY3RpdmUiCiAgICAgICAgZmkKCiAgICAgICAgIyBDaGVjayBmaWxlIG93bmVyc2hpcAogICAgICAgIGlmIFsgIiRsX3VzZXIiID0gInJvb3QiIF07IHRoZW4KICAgICAgICAgICAgbF9vdXQ9IiRsX291dFxuICAtIElzIGNvcnJlY3RseSBvd25lZCBieSB1c2VyOiBcIiRsX3VzZXJcIiIKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxfb3V0Mj0iJGxfb3V0MlxuICAtIElzIG93bmVkIGJ5IHVzZXI6IFwiJGxfdXNlclwiIGFuZCBzaG91bGQgYmUgb3duZWQgYnkgdXNlcjogXCJyb290XCIiCiAgICAgICAgZmkKCiAgICAgICAgIyBDaGVjayBmaWxlIGdyb3VwIG93bmVyc2hpcAogICAgICAgIGlmIFsgIiRsX2dyb3VwIiA9ICJyb290IiBdOyB0aGVuCiAgICAgICAgICAgIGxfb3V0PSIkbF9vdXRcbiAgLSBJcyBjb3JyZWN0bHkgZ3JvdXAtb3duZWQgYnkgZ3JvdXA6IFwiJGxfZ3JvdXBcIiIKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxfb3V0Mj0iJGxfb3V0MlxuICAtIElzIGdyb3VwLW93bmVkIGJ5IGdyb3VwOiBcIiRsX2dyb3VwXCIgYW5kIHNob3VsZCBiZSBncm91cC1vd25lZCBieSBncm91cDogXCJyb290XCIiCiAgICAgICAgZmkKCiAgICAgICAgIyBBcHBlbmQgcmVzdWx0cyB0byBnbG9iYWwgdmFyaWFibGVzCiAgICAgICAgWyAtbiAiJGxfb3V0IiBdICYmIGxfb3V0cHV0PSIkbF9vdXRwdXRcbiAtIEZpbGU6IFwiJGxfZmlsZVwiJGxfb3V0XG4iCiAgICAgICAgWyAtbiAiJGxfb3V0MiIgXSAmJiBsX291dHB1dDI9IiRsX291dHB1dDJcbiAtIEZpbGU6IFwiJGxfZmlsZVwiJGxfb3V0MlxuIgogICAgfQoKICAgICMgRmluZCBhbmQgcHJvY2VzcyByZWxldmFudCBmaWxlcyBpbiAvYm9vdAogICAgd2hpbGUgSUZTPSByZWFkIC1yIC1kICQnXDAnIGxfZ2ZpbGU7IGRvCiAgICAgICAgd2hpbGUgcmVhZCAtciBsX2ZpbGUgbF9tb2RlIGxfdXNlciBsX2dyb3VwOyBkbwogICAgICAgICAgICBmaWxlX211Z19jaGsKICAgICAgICBkb25lIDw8PCAiJChzdGF0IC1MYyAnJW4gJSNhICVVICVHJyAiJGxfZ2ZpbGUiKSIKICAgIGRvbmUgPCA8KGZpbmQgL2Jvb3QgLXR5cGUgZiBcKCAtbmFtZSAnZ3J1YionIC1vIC1uYW1lICd1c2VyLmNmZycgXCkgLXByaW50MCkKCiAgICAjIERpc3BsYXkgcmVzdWx0cwogICAgaWYgWyAteiAiJGxfb3V0cHV0MiIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIlxuLSBBdWRpdCBSZXN1bHQ6XG4gKioqIFBBU1MgKioqXG4tICogQ29ycmVjdGx5IHNldCAqOlxuJGxfb3V0cHV0XG4iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiXG4tIEF1ZGl0IFJlc3VsdDpcbiAqKiBGQUlMICoqXG4gLSAqIFJlYXNvbnMgZm9yIGF1ZGl0IGZhaWx1cmUgKjpcbiRsX291dHB1dDJcbiIKICAgICAgICBbIC1uICIkbF9vdXRwdXQiIF0gJiYgZWNobyAtZSAiIC0gKiBDb3JyZWN0bHkgc2V0ICo6XG4kbF9vdXRwdXRcbiIKICAgIGZpCn0K" | base64 -d | bash


  --] output

- Audit Result:
 *** PASS ***
- * Correctly set *:

 - File: "/boot/grub2/grubenv"
  - Is correctly mode: "0600" which is mode "600" or more restrictive
  - Is correctly owned by user: "root"
  - Is correctly group-owned by group: "root"

 - File: "/boot/grub2/grub.cfg"
  - Is correctly mode: "0600" which is mode "600" or more restrictive
  - Is correctly owned by user: "root"
  - Is correctly group-owned by group: "root"
