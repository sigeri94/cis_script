echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKIyBBdWRpdCBTY3JpcHQgZm9yIERDQ1AgS2VybmVsIE1vZHVsZQoKewogIGxfbW9kX25hbWU9ImRjY3AiICAgICAjIFNldCBrZXJuZWwgbW9kdWxlIG5hbWUKICBsX21vZF90eXBlPSJuZXQiICAgICAgIyBTZXQga2VybmVsIG1vZHVsZSB0eXBlCiAgbF9tb2RfcGF0aD0iJChyZWFkbGluayAtZiAvbGliL21vZHVsZXMvKiova2VybmVsLyRsX21vZF90eXBlIHwgc29ydCAtdSkiICMgSWRlbnRpZnkgbW9kdWxlIHBhdGhzCiAgYV9vdXRwdXQ9KCkgICAgICAgICAgICMgQXJyYXkgZm9yIFBBU1MgY3JpdGVyaWEKICBhX291dHB1dDI9KCkgICAgICAgICAgIyBBcnJheSBmb3IgRkFJTCBjcml0ZXJpYQogIGxfb3V0cHV0Mz0iIiAgICAgICAgICAjIFN0b3JlcyBwYXRocyBvZiBleGlzdGluZyBtb2R1bGVzCiAgCiAgIyBGdW5jdGlvbiB0byBjaGVjayBEQ0NQIG1vZHVsZSBjb25maWd1cmF0aW9uCiAgZl9tb2R1bGVfY2hrKCkgewogICAgYV9zaG93Y29uZmlnPSgpICAgICAjIEFycmF5IGZvciBtb2Rwcm9iZSBjb25maWd1cmF0aW9uCgogICAgIyBDYXB0dXJlIG1vZHByb2JlIGNvbmZpZ3VyYXRpb25zIGZvciB0aGUgbW9kdWxlCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgbF9zaG93Y29uZmlnOyBkbwogICAgICBhX3Nob3djb25maWcrPSgiJGxfc2hvd2NvbmZpZyIpCiAgICBkb25lIDwgPChtb2Rwcm9iZSAtLXNob3djb25maWcgfCBncmVwIC1QIC0tICdcYihpbnN0YWxsfGJsYWNrbGlzdClcaCsnIiR7bF9tb2RfbmFtZS8vLS9ffSInXGInKQoKICAgICMgQ2hlY2sgaWYgbW9kdWxlIGlzIGN1cnJlbnRseSBsb2FkZWQKICAgIGlmICEgbHNtb2QgfCBncmVwIC1xICIkbF9tb2RfbmFtZSI7IHRoZW4KICAgICAgYV9vdXRwdXQrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIG5vdCBsb2FkZWQiKQogICAgZWxzZQogICAgICBhX291dHB1dDIrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIGxvYWRlZCIpCiAgICBmaQoKICAgICMgQ2hlY2sgaWYgbW9kdWxlIGlzIHNldCB0byBub3QgbG9hZGFibGUKICAgIGlmIGdyZXAgLVBxIC0tICdcYmluc3RhbGxcaCsnIiR7bF9tb2RfbmFtZS8vLS9ffSInXGgrXC9iaW5cLyh0cnVlfGZhbHNlKVxiJyA8PDwgIiR7YV9zaG93Y29uZmlnWypdfSI7IHRoZW4KICAgICAgYV9vdXRwdXQrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIG5vdCBsb2FkYWJsZSIpCiAgICBlbHNlCiAgICAgIGFfb3V0cHV0Mis9KCIgLSBrZXJuZWwgbW9kdWxlOiBcIiRsX21vZF9uYW1lXCIgaXMgbG9hZGFibGUiKQogICAgZmkKCiAgICAjIENoZWNrIGlmIG1vZHVsZSBpcyBkZW55bGlzdGVkCiAgICBpZiBncmVwIC1QcSAtLSAnXGJibGFja2xpc3RcaCsnIiR7bF9tb2RfbmFtZS8vLS9ffSInXGInIDw8PCAiJHthX3Nob3djb25maWdbKl19IjsgdGhlbgogICAgICBhX291dHB1dCs9KCIgLSBrZXJuZWwgbW9kdWxlOiBcIiRsX21vZF9uYW1lXCIgaXMgZGVueSBsaXN0ZWQiKQogICAgZWxzZQogICAgICBhX291dHB1dDIrPSgiIC0ga2VybmVsIG1vZHVsZTogXCIkbF9tb2RfbmFtZVwiIGlzIG5vdCBkZW55IGxpc3RlZCIpCiAgICBmaQogIH0KCiAgIyBDaGVjayBpZiBtb2R1bGUgZXhpc3RzIG9uIHRoZSBzeXN0ZW0KICBmb3IgbF9tb2RfYmFzZV9kaXJlY3RvcnkgaW4gJGxfbW9kX3BhdGg7IGRvCiAgICBpZiBbIC1kICIkbF9tb2RfYmFzZV9kaXJlY3RvcnkvJHtsX21vZF9uYW1lLy0vXC99IiBdICYmIFsgLW4gIiQobHMgLUEgIiRsX21vZF9iYXNlX2RpcmVjdG9yeS8ke2xfbW9kX25hbWUvLS9cL30iKSIgXTsgdGhlbgogICAgICBsX291dHB1dDM9IiRsX291dHB1dDNcbiAtIFwiJGxfbW9kX2Jhc2VfZGlyZWN0b3J5XCIiCiAgICAgIGZfbW9kdWxlX2NoawogICAgZWxzZQogICAgICBhX291dHB1dCs9KCIgLSBrZXJuZWwgbW9kdWxlOiBcIiRsX21vZF9uYW1lXCIgZG9lc24ndCBleGlzdCBpbiBcIiRsX21vZF9iYXNlX2RpcmVjdG9yeVwiIikKICAgIGZpCiAgZG9uZQoKICAjIERpc3BsYXkgYXVkaXQgcmVzdWx0cwogIFsgLW4gIiRsX291dHB1dDMiIF0gJiYgZWNobyAtZSAiXG5cbiAtLSBJTkZPIC0tXG4gLSBNb2R1bGU6IFwiJGxfbW9kX25hbWVcIiBleGlzdHMgaW46JGxfb3V0cHV0MyIKICBpZiBbICIkeyNhX291dHB1dDJbQF19IiAtZXEgMCBdOyB0aGVuCiAgICBlY2hvIC1lICJcbi0gQXVkaXQgUmVzdWx0OlxuICoqIFBBU1MgKipcbiR7YV9vdXRwdXRbKl19IgogIGVsc2UKICAgIGVjaG8gLWUgIlxuLSBBdWRpdCBSZXN1bHQ6XG4gKiogRkFJTCAqKlxuIC0gUmVhc29uKHMpIGZvciBhdWRpdCBmYWlsdXJlOlxuJHthX291dHB1dDJbKl19IgogICAgWyAiJHsjYV9vdXRwdXRbQF19IiAtZ3QgMCBdICYmIGVjaG8gLWUgIlxuLSBDb3JyZWN0bHkgc2V0OlxuJHthX291dHB1dFsqXX0iCiAgZmkKfQo=" | base64 -d | bash

---] output
 -- INFO --
 - Module: "dccp" exists in:
 - "/usr/lib/modules/6.8.0-40-generic/kernel/net"
 - "/usr/lib/modules/6.8.0-49-generic/kernel/net"

- Audit Result:
 ** FAIL **
 - Reason(s) for audit failure:
 - kernel module: "dccp" is loadable  - kernel module: "dccp" is not deny listed  - kernel module: "dccp" is loadable  - kernel module: "dccp" is not deny listed

- Correctly set:
 - kernel module: "dccp" is not loaded  - kernel module: "dccp" is not loaded
