echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKewogICAgYV9vdXRwdXQyPSgpCiAgICBhX291dHB1dDM9KCkKICAgIGxfbWF4c2l6ZT0iMTAwMCIgIyBNYXhpbXVtIG51bWJlciBvZiBsb2NhbCBpbnRlcmFjdGl2ZSB1c2VycyBiZWZvcmUgd2FybmluZwogICAgbF92YWxpZF9zaGVsbHM9Il4oJChhd2sgLUYvICckTkYgIT0gIm5vbG9naW4iIHtwcmludH0nIC9ldGMvc2hlbGxzIHwgc2VkIC1ybiAnL15cLy97cywvLFxcXFwvLGc7cH0nIHwgcGFzdGUgLXMgLWQgJ3wnIC0pKSQiCiAgICBhX3VzZXJfYW5kX2hvbWU9KCkgIyBDcmVhdGUgYXJyYXkgd2l0aCBsb2NhbCB1c2VycyBhbmQgdGhlaXIgaG9tZSBkaXJlY3RvcmllcwoKICAgICMgUG9wdWxhdGUgYXJyYXkgd2l0aCB1c2VycyBhbmQgdGhlaXIgaG9tZSBkaXJlY3RvcmllcwogICAgd2hpbGUgcmVhZCAtciBsX2xvY2FsX3VzZXIgbF9sb2NhbF91c2VyX2hvbWU7IGRvCiAgICAgICAgW1sgLW4gIiRsX2xvY2FsX3VzZXIiICYmIC1uICIkbF9sb2NhbF91c2VyX2hvbWUiIF1dICYmIGFfdXNlcl9hbmRfaG9tZSs9KCIkbF9sb2NhbF91c2VyOiRsX2xvY2FsX3VzZXJfaG9tZSIpCiAgICBkb25lIDw8PCAiJChhd2sgLXYgcGF0PSIkbF92YWxpZF9zaGVsbHMiIC1GOiAnJChORikgfiBwYXQgeyBwcmludCAkMSwgJChORi0xKSB9JyAvZXRjL3Bhc3N3ZCkiCgogICAgbF9hc2l6ZT0iJHsjYV91c2VyX2FuZF9ob21lW0BdfSIgIyBDaGVjayBudW1iZXIgb2YgdXNlcnMKICAgIGlmIFsgIiR7I2FfdXNlcl9hbmRfaG9tZVtAXX0iIC1ndCAiJGxfbWF4c2l6ZSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiIgIiIgIioqIElORk8gKioiIFwKICAgICAgICAiIC0gXCIkbF9hc2l6ZVwiIExvY2FsIGludGVyYWN0aXZlIHVzZXJzIGZvdW5kIG9uIHRoZSBzeXN0ZW0iIFwKICAgICAgICAiIC0gVGhpcyBtYXkgYmUgYSBsb25nLXJ1bm5pbmcgY2hlY2siICIiCiAgICBmaQoKICAgICMgRnVuY3Rpb24gdG8gY2hlY2sgZmlsZSBhY2Nlc3MgcGVybWlzc2lvbnMKICAgIGZpbGVfYWNjZXNzX2NoaygpIHsKICAgICAgICBhX2FjY2Vzc19vdXQ9KCkKICAgICAgICBsX21heD0iJChwcmludGYgJyVvJyAkKCgwNzc3ICYgfiRsX21hc2spKSkiCgogICAgICAgIGlmIFsgJCgobF9tb2RlICYgbF9tYXNrKSkgLWd0IDAgXTsgdGhlbgogICAgICAgICAgICBhX2FjY2Vzc19vdXQrPSgiIC0gRmlsZTogXCIkbF9oZGZpbGVcIiBpcyBtb2RlOiBcIiRsX21vZGVcIiBhbmQgc2hvdWxkIGJlIG1vZGU6IFwiJGxfbWF4XCIgb3IgbW9yZSByZXN0cmljdGl2ZSIpCiAgICAgICAgZmkKCiAgICAgICAgaWYgW1sgISAiJGxfb3duZXIiID1+ICgkbF91c2VyKSBdXTsgdGhlbgogICAgICAgICAgICBhX2FjY2Vzc19vdXQrPSgiIC0gRmlsZTogXCIkbF9oZGZpbGVcIiBvd25lZCBieTogXCIkbF9vd25lclwiIGFuZCBzaG91bGQgYmUgb3duZWQgYnkgXCIke2xfdXNlci8vfC8gb3IgfVwiIikKICAgICAgICBmaQoKICAgICAgICBpZiBbWyAhICIkbF9nb3duZXIiID1+ICgkbF9ncm91cCkgXV07IHRoZW4KICAgICAgICAgICAgYV9hY2Nlc3Nfb3V0Kz0oIiAtIEZpbGU6IFwiJGxfaGRmaWxlXCIgZ3JvdXAgb3duZWQgYnk6IFwiJGxfZ293bmVyXCIgYW5kIHNob3VsZCBiZSBncm91cCBvd25lZCBieSBcIiR7bF9ncm91cC8vfC8gb3IgfVwiIikKICAgICAgICBmaQogICAgfQoKICAgICMgUHJvY2VzcyBlYWNoIHVzZXIgYW5kIHRoZWlyIGhvbWUgZGlyZWN0b3J5CiAgICB3aGlsZSBJRlM9OiByZWFkIC1yIGxfdXNlciBsX2hvbWU7IGRvCiAgICAgICAgYV9kb3RfZmlsZT0oKQogICAgICAgIGFfbmV0cmM9KCkKICAgICAgICBhX25ldHJjX3dhcm49KCkKICAgICAgICBhX2Job3V0PSgpCiAgICAgICAgYV9oZGlyb3V0PSgpCgogICAgICAgIGlmIFsgLWQgIiRsX2hvbWUiIF07IHRoZW4KICAgICAgICAgICAgbF9ncm91cD0iJChpZCAtZ24gIiRsX3VzZXIiIHwgeGFyZ3MpIgogICAgICAgICAgICBsX2dyb3VwPSIke2xfZ3JvdXAvLyAvfH0iCgogICAgICAgICAgICAjIENoZWNrIGRvdGZpbGVzIGFuZCBvdGhlciBzZW5zaXRpdmUgZmlsZXMKICAgICAgICAgICAgd2hpbGUgSUZTPSByZWFkIC1yIC1kICQnXDAnIGxfaGRmaWxlOyBkbwogICAgICAgICAgICAgICAgd2hpbGUgcmVhZCAtciBsX21vZGUgbF9vd25lciBsX2dvd25lcjsgZG8KICAgICAgICAgICAgICAgICAgICBjYXNlICIkKGJhc2VuYW1lICIkbF9oZGZpbGUiKSIgaW4KICAgICAgICAgICAgICAgICAgICAgICAgLmZvcndhcmQgfCAucmhvc3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhX2RvdF9maWxlKz0oIiAtIEZpbGU6IFwiJGxfaGRmaWxlXCIgZXhpc3RzIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgICAgIC5uZXRyYykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxfbWFzaz0nMDE3NycKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfYWNjZXNzX2NoawogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgWyAiJHsjYV9hY2Nlc3Nfb3V0W0BdfSIgLWd0IDAgXTsgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFfbmV0cmMrPSgiJHthX2FjY2Vzc19vdXRbQF19IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhX25ldHJjX3dhcm4rPSgiIC0gRmlsZTogXCIkbF9oZGZpbGVcIiBleGlzdHMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgICAgIC5iYXNoX2hpc3RvcnkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsX21hc2s9JzAxNzcnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlX2FjY2Vzc19jaGsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgIiR7I2FfYWNjZXNzX291dFtAXX0iIC1ndCAwIF0gJiYgYV9iaG91dCs9KCIke2FfYWNjZXNzX291dFtAXX0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxfbWFzaz0nMDEzMycKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfYWNjZXNzX2NoawogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAiJHsjYV9hY2Nlc3Nfb3V0W0BdfSIgLWd0IDAgXSAmJiBhX2hkaXJvdXQrPSgiJHthX2FjY2Vzc19vdXRbQF19IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgZXNhYwogICAgICAgICAgICAgICAgZG9uZSA8IDwoc3RhdCAtTGMgJyUjYSAlVSAlRycgIiRsX2hkZmlsZSIpCiAgICAgICAgICAgIGRvbmUgPCA8KGZpbmQgIiRsX2hvbWUiIC14ZGV2IC10eXBlIGYgLW5hbWUgJy4qJyAtcHJpbnQwKQogICAgICAgIGZpCgogICAgICAgICMgQ29sbGVjdCByZXN1bHRzIGZvciB0aGUgdXNlcgogICAgICAgIGlmIFtbICIkeyNhX2RvdF9maWxlW0BdfSIgLWd0IDAgfHwgIiR7I2FfbmV0cmNbQF19IiAtZ3QgMCB8fCAiJHsjYV9iaG91dFtAXX0iIC1ndCAwIHx8ICIkeyNhX2hkaXJvdXRbQF19IiAtZ3QgMCBdXTsgdGhlbgogICAgICAgICAgICBhX291dHB1dDIrPSgiIC0gVXNlcjogXCIkbF91c2VyXCIgSG9tZSBEaXJlY3Rvcnk6IFwiJGxfaG9tZVwiIiAiJHthX2RvdF9maWxlW0BdfSIgIiR7YV9uZXRyY1tAXX0iICIke2FfYmhvdXRbQF19IiAiJHthX2hkaXJvdXRbQF19IikKICAgICAgICBmaQoKICAgICAgICBpZiBbICIkeyNhX25ldHJjX3dhcm5bQF19IiAtZ3QgMCBdOyB0aGVuCiAgICAgICAgICAgIGFfb3V0cHV0Mys9KCIgLSBVc2VyOiBcIiRsX3VzZXJcIiBIb21lIERpcmVjdG9yeTogXCIkbF9ob21lXCIiICIke2FfbmV0cmNfd2FybltAXX0iKQogICAgICAgIGZpCiAgICBkb25lIDw8PCAiJChwcmludGYgJyVzXG4nICIke2FfdXNlcl9hbmRfaG9tZVtAXX0iKSIKCiAgICAjIERpc3BsYXkgcmVzdWx0cwogICAgaWYgWyAiJHsjYV9vdXRwdXQyW0BdfSIgLWxlIDAgXTsgdGhlbgogICAgICAgICMgUGFzcyBpZiBubyBpc3N1ZXMgZm91bmQKICAgICAgICBbICIkeyNhX291dHB1dDNbQF19IiAtZ3QgMCBdICYmIHByaW50ZiAnJXNcbicgIioqIFdBUk5JTkcgKioiICIke2Ffb3V0cHV0M1tAXX0iCiAgICAgICAgcHJpbnRmICclc1xuJyAiLSBBdWRpdCBSZXN1bHQ6IiAiKiogUEFTUyAqKiIKICAgIGVsc2UKICAgICAgICAjIEZhaWwgaWYgaXNzdWVzIGV4aXN0CiAgICAgICAgcHJpbnRmICclc1xuJyAiLSBBdWRpdCBSZXN1bHQ6IiAiKiogRkFJTCAqKiIgIiAtICogUmVhc29ucyBmb3IgYXVkaXQgZmFpbHVyZSAqIDoiICIke2Ffb3V0cHV0MltAXX0iCiAgICAgICAgWyAiJHsjYV9vdXRwdXQzW0BdfSIgLWd0IDAgXSAmJiBwcmludGYgJyVzXG4nICIqKiBXQVJOSU5HICoqIiAiJHthX291dHB1dDNbQF19IgogICAgZmkKfQo=" | base64 -d | bash

  ---] output
  - Audit Result:
** FAIL **
 - * Reasons for audit failure * :
 - User: "user2" Home Directory: "/home/user2"
 - File: "/home/user2/.bash_logout" owned by: "nonexistent_user" and should be owned by "user2"
 - File: "/home/user2/.bash_logout" group owned by: "user2" and should be group owned by "user1"
 - File: "/home/user2/.bash_profile" owned by: "nonexistent_user" and should be owned by "user2"
 - File: "/home/user2/.bash_profile" group owned by: "user2" and should be group owned by "user1"
 - File: "/home/user2/.bashrc" owned by: "nonexistent_user" and should be owned by "user2"
 - File: "/home/user2/.bashrc" group owned by: "user2" and should be group owned by "user1"
 - User: "user3" Home Directory: "/home/user3"
 - File: "/home/user3/.bash_logout" owned by: "UNKNOWN" and should be owned by "user3"
 - File: "/home/user3/.bash_logout" group owned by: "user3" and should be group owned by "user1"
 - File: "/home/user3/.bash_profile" owned by: "UNKNOWN" and should be owned by "user3"
 - File: "/home/user3/.bash_profile" group owned by: "user3" and should be group owned by "user1"
 - File: "/home/user3/.bashrc" owned by: "UNKNOWN" and should be owned by "user3"
 - File: "/home/user3/.bashrc" group owned by: "user3" and should be group owned by "user1"

